{"version":3,"file":"index-BRTTY4pc.js","sources":["../../../../components/BaseInput.vue","../../../../pages/index.vue"],"sourcesContent":["<script lang=\"ts\" setup>\nimport type { MyData } from \"/types/types.ts\";\n\nconst emits = defineEmits([\"click-request\"]);\n\nconst click = () => {\n\temits(\"click-request\");\n};\n\nconst city = inject(\"city\") as MyData;\n</script>\n\n<template>\n\t<div>\n\t\t<input\n\t\t\tv-model=\"city.message\"\n\t\t\t@keyup.enter=\"click\"\n\t\t\tclass=\"text-black relative rounded transition bg-transparent border-2 border-slate-700 focus:outline-none focus:bg-opacity-15 focus:bg-slate-200 py-1 px-2 placeholder:text-black\"\n\t\t\ttype=\"text\"\n\t\t\tplaceholder=\"Enter your city\"\n\t\t/>\n\t</div>\n</template>\n","<script lang=\"ts\" setup>\nimport axios from \"axios\";\nimport autoAnimate from \"@formkit/auto-animate\";\n\ninterface CityResponse {\n\tname: string;\n}\n\nlet info: CityResponse | null = null;\n\nlet id: number = 0;\n\ninterface IWeatherCard {\n\tid: number;\n\tcity: string;\n\tdeg: number;\n\tcondition: string;\n\thumidity: number;\n\twind: number;\n\tdate: string;\n\tnextDay: object;\n\tthirdDay: object;\n\tfourthDay: object;\n\tweatherId: string;\n}\n\ninterface IParams {\n\tday1: { dt_txt: string };\n\tday2: { dt_txt: string };\n\tday3: { dt_txt: string };\n\tday4: { dt_txt: string };\n}\n\n// Иконки для погоды с их id\nconst weatherIcons: Record<string, string> = {\n\t\"01d\": \"/weather/clear-sky.png\", // ясное небо (день)\n\t\"01n\": \"/weather/clear-sky.png\", // ясное небо (ночь)\n\t\"02d\": \"/weather/few-clouds.png\", // небольшая облачность (день)\n\t\"02n\": \"/weather/few-clouds.png\", // небольшая облачность (ночь)\n\t\"03d\": \"/weather/few-clouds.png\", // рассеянные облака (день)\n\t\"03n\": \"/weather/few-clouds.png\", // рассеянные облака (ночь)\n\t\"04d\": \"/weather/broken-clouds.png\", // облачно (день)\n\t\"04n\": \"/weather/broken-clouds.png\", // облачно (ночь)\n\t\"09d\": \"/weather/shower-rain.png\", // дождь (день)\n\t\"09n\": \"/weather/shower-rain.png\", // дождь (ночь)\n\t\"10d\": \"/weather/rain.png\", // дождь (день)\n\t\"10n\": \"/weather/rain.png\", // дождь (ночь)\n\t\"11d\": \"/weather/thunderstorm.png\", // гроза (день)\n\t\"11n\": \"/weather/thunderstorm.png\", // гроза (ночь)\n\t\"13d\": \"/weather/snow.png\", // снег (день)\n\t\"13n\": \"/weather/snow.png\", // снег (ночь)\n\t\"50d\": \"/weather/mist.png\", // туман (день)\n\t\"50n\": \"/weather/mist.png\", // туман (ночь)\n};\n\nconst weatherCards: IWeatherCard[] = [];\nconst refWeatherCards = ref(weatherCards);\n\nlet error: string = \"\";\nconst refError = ref(error);\n\n// Добавление карточки с погодой\nconst addCity = () => {\n\tif (city.message.trim().length < 2) {\n\t\trefError.value = \"You need to enter a name with a length of more than 1.\";\n\t\treturn;\n\t}\n\trefError.value = \"\";\n\n\t// Обрезаем данную в API дату до более короткой (год/месяц/число)\n\tconst cutToSpace = (str: string): string => {\n\t\tconst currentDate: string = str;\n\t\tconst index: number = currentDate.indexOf(\" \");\n\t\tconst result: string = currentDate.substring(0, index);\n\t\treturn result;\n\t};\n\n\taxios\n\t\t.get(\n\t\t\t`https://api.openweathermap.org/data/2.5/forecast?q=${city.message}&units=metric&lang=ru&appid=b93ead9e942361f9190e775a6220a511`\n\t\t)\n\n\t\t.then(res => {\n\t\t\tinfo = res.data;\n\t\t\tcity.message = \"\";\n\n\t\t\t// Фильтрация по датам обеспечивающая корректное отображение только 4 различных дней\n\t\t\tconst daysMap = new Map<string, any>();\n\n\t\t\tfor (const item of info.list) {\n\t\t\t\tconst itemDate = new Date(item.dt_txt).toDateString();\n\t\t\t\tif (!daysMap.has(itemDate)) {\n\t\t\t\t\tdaysMap.set(itemDate, item);\n\t\t\t\t}\n\t\t\t\tif (daysMap.size > 3) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst days = Array.from(daysMap.values());\n\t\t\trefWeatherCards.value.push({\n\t\t\t\tid: id++,\n\t\t\t\tcity: info.city.name,\n\t\t\t\tdeg: Math.round(days[0].main.temp),\n\t\t\t\tcondition: days[0].weather[0].description,\n\t\t\t\thumidity: days[0].main.humidity,\n\t\t\t\twind: days[0].wind.speed,\n\t\t\t\tdate: cutToSpace(days[0].dt_txt),\n\t\t\t\tweatherId: days[0].weather[0].icon,\n\t\t\t\tnextDay: {\n\t\t\t\t\tdeg: Math.round(days[1].main.temp),\n\t\t\t\t\tcondition: days[1].weather[0].description,\n\t\t\t\t\thumidity: days[1].main.humidity,\n\t\t\t\t\twind: days[1].wind.speed,\n\t\t\t\t\tdate: cutToSpace(days[1].dt_txt),\n\t\t\t\t},\n\t\t\t\tthirdDay: {\n\t\t\t\t\tdeg: Math.round(days[2].main.temp),\n\t\t\t\t\tcondition: days[2].weather[0].description,\n\t\t\t\t\thumidity: days[2].main.humidity,\n\t\t\t\t\twind: days[2].wind.speed,\n\t\t\t\t\tdate: cutToSpace(days[2].dt_txt),\n\t\t\t\t},\n\t\t\t\tfourthDay: {\n\t\t\t\t\tdeg: Math.round(days[3].main.temp),\n\t\t\t\t\tcondition: days[3].weather[0].description,\n\t\t\t\t\thumidity: days[3].main.humidity,\n\t\t\t\t\twind: days[3].wind.speed,\n\t\t\t\t\tdate: cutToSpace(days[3].dt_txt),\n\t\t\t\t},\n\t\t\t});\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error(\"Error fetching data:\", error);\n\t\t\t// Обработка ошибок:\n\t\t\trefError.value = \"The name of the city was entered incorrectly.\";\n\t\t});\n};\n\nconst city = reactive<MyData>({ message: \"\" });\n\nprovide(\"city\", city);\n\n// Подключение анимаций из библиотеки AutoAnimate\nconst animation = ref();\nonMounted(() => {\n\tautoAnimate(animation.value);\n});\n\n// Удаление всех карточек\nconst deleteAllCards = () => {\n\trefWeatherCards.value.splice(0, refWeatherCards.value.length);\n\tid = 0;\n};\n\n// Удаление конкретной карточки\nconst deleteCard = cardId => {\n\tconsole.log(cardId);\n\trefWeatherCards.value.splice(cardId, 1);\n\tid--;\n};\n</script>\n\n<template>\n\t<div\n\t\tclass=\"flex flex-col items-center gap-5 h-full min-h-[500px] justify-center\"\n\t>\n\t\t<div\n\t\t\tref=\"animation\"\n\t\t\tclass=\"flex gap-2 carousel w-full relative justify-start\"\n\t\t>\n\t\t\t<!-- Рендер главной и дочерних погодных карточек -->\n\t\t\t<TodayWeather\n\t\t\t\tclass=\"carousel-item w-full max-w-96 flex items-center justify-center\"\n\t\t\t\tv-for=\"card in refWeatherCards\"\n\t\t\t\t:key=\"card.id\"\n\t\t\t\t:city=\"card.city\"\n\t\t\t\t:deg=\"card.deg\"\n\t\t\t\t:condition=\"card.condition\"\n\t\t\t\t:humidity=\"card.humidity\"\n\t\t\t\t:wind=\"card.wind\"\n\t\t\t\t:date=\"card.date\"\n\t\t\t\t@delete-request=\"deleteCard(card.id)\"\n\t\t\t\t:id=\"'item' + card.id\"\n\t\t\t>\n\t\t\t\t<!-- Не совсем соответствует тз, но я решил, что это тоже неплохое решение -->\n\t\t\t\t<!-- Рендер дочерних карточек с погодой (на следующие три дня) -->\n\t\t\t\t<template v-slot:cards>\n\t\t\t\t\t<LaterWeather\n\t\t\t\t\t\t:deg=\"card.nextDay.deg\"\n\t\t\t\t\t\t:condition=\"card.nextDay.condition\"\n\t\t\t\t\t\t:humidity=\"card.nextDay.humidity\"\n\t\t\t\t\t\t:wind=\"card.nextDay.wind\"\n\t\t\t\t\t\t:date=\"card.nextDay.date\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t<LaterWeather\n\t\t\t\t\t\t:deg=\"card.thirdDay.deg\"\n\t\t\t\t\t\t:condition=\"card.thirdDay.condition\"\n\t\t\t\t\t\t:humidity=\"card.thirdDay.humidity\"\n\t\t\t\t\t\t:wind=\"card.thirdDay.wind\"\n\t\t\t\t\t\t:date=\"card.thirdDay.date\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t<LaterWeather\n\t\t\t\t\t\t:deg=\"card.fourthDay.deg\"\n\t\t\t\t\t\t:condition=\"card.fourthDay.condition\"\n\t\t\t\t\t\t:humidity=\"card.fourthDay.humidity\"\n\t\t\t\t\t\t:wind=\"card.fourthDay.wind\"\n\t\t\t\t\t\t:date=\"card.fourthDay.date\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t\t<!-- Рендер иконок в зависимости от погодных условий -->\n\t\t\t\t<template v-slot:weather-icon>\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-if=\"card.weatherId === '01d' || card.weatherId === '01n'\"\n\t\t\t\t\t\t:src=\"weatherIcons['01d']\"\n\t\t\t\t\t\talt=\"clear sky\"\n\t\t\t\t\t/>\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-else-if=\"card.weatherId === '02d' || card.weatherId === '02n'\"\n\t\t\t\t\t\t:src=\"weatherIcons['02d']\"\n\t\t\t\t\t\talt=\"few clouds\"\n\t\t\t\t\t/>\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-else-if=\"card.weatherId === '03d' || card.weatherId === '03n'\"\n\t\t\t\t\t\t:src=\"weatherIcons['03d']\"\n\t\t\t\t\t\talt=\"scattered clouds\"\n\t\t\t\t\t/>\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-else-if=\"card.weatherId === '04d' || card.weatherId === '04n'\"\n\t\t\t\t\t\t:src=\"weatherIcons['04d']\"\n\t\t\t\t\t\talt=\"broken clouds\"\n\t\t\t\t\t/>\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-else-if=\"card.weatherId === '09d' || card.weatherId === '09n'\"\n\t\t\t\t\t\t:src=\"weatherIcons['09d']\"\n\t\t\t\t\t\talt=\"shower rain\"\n\t\t\t\t\t/>\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-else-if=\"card.weatherId === '10d' || card.weatherId === '10n'\"\n\t\t\t\t\t\t:src=\"weatherIcons['10d']\"\n\t\t\t\t\t\talt=\"rain\"\n\t\t\t\t\t/>\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-else-if=\"card.weatherId === '11d' || card.weatherId === '11n'\"\n\t\t\t\t\t\t:src=\"weatherIcons['11d']\"\n\t\t\t\t\t\talt=\"thunderstorm\"\n\t\t\t\t\t/>\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-else-if=\"card.weatherId === '13d' || card.weatherId === '13n'\"\n\t\t\t\t\t\t:src=\"weatherIcons['13d']\"\n\t\t\t\t\t\talt=\"snow\"\n\t\t\t\t\t/>\n\t\t\t\t\t<img\n\t\t\t\t\t\tv-else-if=\"card.weatherId === '50d' || card.weatherId === '50n'\"\n\t\t\t\t\t\t:src=\"weatherIcons['50d']\"\n\t\t\t\t\t\talt=\"mist\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</TodayWeather>\n\t\t</div>\n\t\t<div\n\t\t\tclass=\"flex justify-center w-full py-2 gap-2 absolute bottom-0 flex-wrap\"\n\t\t>\n\t\t\t<a\n\t\t\t\tv-for=\"card in refWeatherCards\"\n\t\t\t\t:href=\"'#item' + card.id\"\n\t\t\t\tclass=\"btn btn-xs\"\n\t\t\t\t>{{ card.id + 1 }}</a\n\t\t\t>\n\t\t</div>\n\t\t<div class=\"flex gap-1 flex-col items-center mt-auto pb-4 relative\">\n\t\t\t<!-- Отображение ошибки ввода -->\n\t\t\t<p class=\"text-red-900\">{{ refError }}</p>\n\t\t\t<div class=\"flex\">\n\t\t\t\t<BaseInput @click-request=\"addCity()\" />\n\t\t\t\t<div\n\t\t\t\t\tclass=\"absolute -bottom-2 text-slate-800 min-w-[200px] text-nowrap text-center\"\n\t\t\t\t>\n\t\t\t\t\tYou want to check weather at\n\t\t\t\t\t{{ city.message == \"\" ? \"your city\" : \"<\" + city.message + \">\" }}\n\t\t\t\t</div>\n\t\t\t\t<BaseButton v-if=\"city.message.length > 0\" @click-request=\"addCity()\"\n\t\t\t\t\t>Add</BaseButton\n\t\t\t\t>\n\t\t\t\t<BaseButton v-else disabled @click-request=\"addCity()\">Add</BaseButton>\n\t\t\t</div>\n\t\t\t<BaseButton\n\t\t\t\tv-show=\"weatherCards.length > 0\"\n\t\t\t\t@click-request=\"deleteAllCards()\"\n\t\t\t\tclass=\"absolute -bottom-10\"\n\t\t\t>\n\t\t\t\tDelete all\n\t\t\t</BaseButton>\n\t\t</div>\n\t</div>\n</template>\n"],"names":["error"],"mappings":"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"}